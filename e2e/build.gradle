plugins {
    id 'java'
}

group 'com.revolut'
version '0.1'

sourceCompatibility = 1.8

repositories {
    mavenCentral()
}

dependencies {
    testImplementation 'org.glassfish.jersey.core:jersey-client:2.25.1'
    testImplementation 'org.glassfish.jersey.media:jersey-media-json-jackson:2.25.1'
    testImplementation 'io.rest-assured:rest-assured:4.1.2'
    testCompile group: 'junit', name: 'junit', version: '4.12'
    testImplementation 'io.cucumber:cucumber-java:4.7.4'
    testImplementation 'io.cucumber:cucumber-junit:4.7.4'
    testImplementation group: 'com.google.guava', name: 'guava', version: '28.1-jre'

}

configurations {
    cucumberRuntime {
        extendsFrom testImplementation
    }
}

task cucumber(type: Test) {
    dependsOn assemble, compileTestJava
    doLast {
        javaexec {
            systemProperty 'env', System.getProperty('env')
            main = "cucumber.api.cli.Main"
            classpath = configurations.cucumberRuntime + sourceSets.main.output + sourceSets.test.output
            args = ['--plugin', "json:report/cucumber.json", '--glue', 'com.revolut.challenge.e2e', 'src/test/resources']
        }
    }
}
